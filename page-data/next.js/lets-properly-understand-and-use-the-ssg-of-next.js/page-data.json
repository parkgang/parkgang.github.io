{"componentChunkName":"component---src-templates-blog-post-js","path":"/next.js/lets-properly-understand-and-use-the-ssg-of-next.js/","result":{"data":{"site":{"siteMetadata":{"title":"Parkgang Dev Log","author":"parkgang","siteUrl":"https://parkgang.github.io","comment":{"disqusShortName":"","utterances":"parkgang/parkgang.github.io"},"sponsor":{"buyMeACoffeeId":"parkgang"}}},"markdownRemark":{"id":"8d2da0e1-201d-5d86-a6de-4bf314c10d07","excerpt":"Intro next.js를 추천할 때 가장 자랑하는 부분이 SSR를 지원한다! 인데 내가 아는 SSR은 Server Side에서 각 페이지 별로 html을 생성해서 Response (혹은 파일 서빙) 을 해주는 것인데 next.js를 공부하고 사용해보면서 이부분에서 아직 찝찝한 부분이 있어서 next.js도 그렇게 동작하는게 맞는가? 에 대한 의문이 항상있었습니다. 물론 SSR 단어 뜻 그대로 서버 측에서 렌더링 한다라는 뜻을 의미하지만 필자는 계속 JSP 같은 전통적인 SSR…","html":"<h1 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h1>\n<p>next.js를 추천할 때 가장 자랑하는 부분이 SSR를 지원한다! 인데 내가 아는 SSR은 Server Side에서 각 페이지 별로 html을 생성해서 Response (혹은 파일 서빙) 을 해주는 것인데 next.js를 공부하고 사용해보면서 이부분에서 아직 찝찝한 부분이 있어서 next.js도 그렇게 동작하는게 맞는가? 에 대한 의문이 항상있었습니다.</p>\n<blockquote>\n<p>물론 SSR 단어 뜻 그대로 서버 측에서 렌더링 한다라는 뜻을 의미하지만 필자는 계속 JSP 같은 전통적인 SSR와 엄청 햇갈렸습니다.</p>\n</blockquote>\n<p>그동안 CRA 환경 즉, SPA에서 개발을 하고 있었는데 갑자기 next.js의 원리에 대해 궁금해서 이참에 다시 정리를 해보면서 얻은 경험치에 대해 공유해보려고 합니다.</p>\n<p>그럼 SPA를 가공할 수 있는 여러 형태라고 할 수 있는 CSR, SSG, SSR를 비교하면서 설명해보도록 하겠습니다.</p>\n<blockquote>\n<p>추가적으로 해당 글에서는 SPA, CSR, SSG, SSR과 같은 단어 설명과 next.js에 대한 설명을 포함하고 있지 않습니다.</p>\n</blockquote>\n<h1 id=\"내가-알고-있던-ssr은\" style=\"position:relative;\"><a href=\"#%EB%82%B4%EA%B0%80-%EC%95%8C%EA%B3%A0-%EC%9E%88%EB%8D%98-ssr%EC%9D%80\" aria-label=\"내가 알고 있던 ssr은 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내가 알고 있던 SSR은?</h1>\n<p>필자는 SSR를 들었을 때 가장 처음으로 떠오른 것은 jsp 이였습니다.</p>\n<p>Client가 요청한 페이지를 Server Side에서 열심히 가공해서 Response 하는 것을 말이죠</p>\n<p>이는 주로 SSR를 설명할 때 가장 많이 소개되는 시나리오로 다른 페이지로 넘어갈 때 페이지의 내용을 새로 가공해서 넘겨주기 때문에 <strong>화면이 깜빡</strong> 한다 라고 하는 그 메커니즘을 가진 친구입니다.</p>\n<p>근데 next.js 해보면 SSR임에 불구하고 아주 부드럽게 CSR처럼 화면 전환이 이뤄지는 것을 볼 수 있습니다.</p>\n<blockquote>\n<p><q>어라…? 내가 뭔가 잘못 이해했구나…</q></p>\n</blockquote>\n<h2 id=\"그런데-어떻게-전역-상태가-관리되는-거지\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%9F%B0%EB%8D%B0-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A0%84%EC%97%AD-%EC%83%81%ED%83%9C%EA%B0%80-%EA%B4%80%EB%A6%AC%EB%90%98%EB%8A%94-%EA%B1%B0%EC%A7%80\" aria-label=\"그런데 어떻게 전역 상태가 관리되는 거지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그런데 어떻게 전역 상태가 관리되는 거지?</h2>\n<p>이뿐만이 아니라 위에 내가 알고 있는 SSR을 대입하면 전역 상태는 어떻게 관리되는 건지 의문이 생깁니다.</p>\n<p>이동하는 매 페이지는 다른 html인데 전역 상태가 불가능 할 것입니다.<br>\n하지만 next.js는 SSR임에 불구하고 잘 처리됩니다.</p>\n<p>사실 next.js only SSR이 아닌 CSR과 SSR의 장점을 섞은 방식인 것을 알 수 있습니다.<br>\n그럼에도 불구하고 SSR 단어는 계속 이전 개념과 충돌하게 되었습니다.</p>\n<p>혹시라도 저와 같으신 분이 있다면 해당 글로 이해가 풀리셨으면 좋겠습니다.</p>\n<h1 id=\"그럼-nextjs의-ssr은-어떻게-작동하는거야\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%9F%BC-nextjs%EC%9D%98-ssr%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8A%94%EA%B1%B0%EC%95%BC\" aria-label=\"그럼 nextjs의 ssr은 어떻게 작동하는거야 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그럼 next.js의 SSR은 어떻게 작동하는거야?</h1>\n<!-- 일부로 ### 입니다 ##으로 하니까 글씨가 너무 크게 나와서 별로입니다ㅠㅠ -->\n<h3 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL;DR</h3>\n<ol>\n<li>next.js에서 말하는 SSR도 사실 하나 뿐인 SPA으로 동작합니다.</li>\n<li>다만, empty html의 SPA 형태가 아닌 Server Side에서 미리 가공된 html을 가지고 SPA으로 동작합니다.</li>\n</ol>\n<p>가장 햇갈리고 오해하기 쉬운 것이 SSG, SSR 개념이 들어가니 모든 페이지가 정적으로 구어져있고 페이지 이동마다 Server Side에서 구어진 파일을 응답해서 탐색하겟지? 일 수 있습니다.</p>\n<p>하지만 아닙니다! <ins><strong>첫 요청하는 페이지에 대해서만</strong></ins> SSG 혹은 SSR으로 Server Side에서 미리 구어 놓은 파일을 응답하는 것이고 그 이후부터는 router를 통해 이동하는 것은 CSR 입니다.</p>\n<p>사실 next.js에서 말하는 SSG와 SSR은 Server Side에서 build 시점에 구어 줄까?<sup>SSG</sup> 아님 요청마다 구어 줄까?<sup>SSR</sup> 라고 봐도 무방합니다.</p>\n<p>결국에는 첫 요청하는 페이지만 Server Side에서 구어진 파일을 사용하고 이후 부터는 CSR입니다.</p>\n<p>그렇기 때문에 전역 상태와 같은 것이 가능한 것입니다. 첫 요청한 페이지를 SPA 삼아서 CSR를 하기 때문이죠 마치 다른 페이지로 이동하면 다른 구어진 파일을 사용했구나 싶을 수 있지만 사실 CSR으로 이동 중 인 것입니다.</p>\n<blockquote>\n<p>물론 이동한 경로에서 새로고침을 하면 해당 URL 기준으로 다시 구어진 파일을 받겠지만요</p>\n</blockquote>\n<p>그래서 next.js의 SSR를 설명할 때 SSG와 SSR를 빼고 설명하기가 참 어려운 거 같습니다.</p>\n<p>이 때문에 next.js에서 말하는 SSR을 말 그대로 Server Side에서 처리하는 렌더링이라고 생각하시는게 이해에 좋습니다.</p>\n<blockquote>\n<p>참고로 next.js의 Pre Rendering 시스템은 기본적으로 SSG으로 동작하며 Server Side에서 build시 기본 파일을 구어내고 매 요청마다 재사용하게 됩니다.</p>\n</blockquote>\n<h1 id=\"serverless\" style=\"position:relative;\"><a href=\"#serverless\" aria-label=\"serverless permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>serverless</h1>\n<p>Static으로 구어지기 때문에 next.js server 이외 serverless deployment가 동작할 수 있는 것을 생각할 수 있습니다.</p>\n<p>사실 이 부분이 궁금했습니다. 이걸 잘 응용하면 굳이 정적 사이트 생성을 위해서 <code class=\"language-text\">Gatsby.js</code> 을 사용하지 않을 수 있을까라는 생각으로 말이죠</p>\n<h2 id=\"한번-해보자\" style=\"position:relative;\"><a href=\"#%ED%95%9C%EB%B2%88-%ED%95%B4%EB%B3%B4%EC%9E%90\" aria-label=\"한번 해보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>한번 해보자</h2>\n<p>실습을 위해서 <a href=\"https://github.com/parkgang/next.js-ssg-tutorial\">parkgang/next.js-ssg-tutorial</a> 코드를 참고하시면 됩니다.</p>\n<blockquote>\n<p>코드 상태는 정말 안 좋으므로 돌아가는 샘플로서만 사용해 주세요. (해당 글 샘플을 위해서 태어난 코드라 상태가 🤭)</p>\n</blockquote>\n<blockquote>\n<p>해당 글을 위해서 따로 소스 코드를 생성할 까 싶었지만 사전에 미리 SSG를 테스트 하면서 이용 된 <a href=\"https://docs.microsoft.com/ko-kr/azure/static-web-apps/deploy-nextjs\">정적으로 렌더링된 Next.js 웹 사이트 배포</a> 템플릿이 글에 사용할 수 있어서 해당 템플릿 코드를 수정해서 사용했습니다.</p>\n</blockquote>\n<h2 id=\"export\" style=\"position:relative;\"><a href=\"#export\" aria-label=\"export permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>export</h2>\n<p>제가 미리 <code class=\"language-text\">export</code> 명령어를 작성해 놓았습니다.</p>\n<p><code class=\"language-text\">next</code> 디렉터리에서 <code class=\"language-text\">npm run export</code> 를 실행하여 <code class=\"language-text\">express/public</code> 으로 Static Html으로 export 되는지 확인합니다.</p>\n<blockquote>\n<p>굳이 <code class=\"language-text\">express/public</code> 으로 export 하는 이유는 이따가 설명드릴께요</p>\n</blockquote>\n<h2 id=\"왜-파일시스템에서는-안되는-걸까\" style=\"position:relative;\"><a href=\"#%EC%99%9C-%ED%8C%8C%EC%9D%BC%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%97%90%EC%84%9C%EB%8A%94-%EC%95%88%EB%90%98%EB%8A%94-%EA%B1%B8%EA%B9%8C\" aria-label=\"왜 파일시스템에서는 안되는 걸까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>왜 파일시스템에서는 안되는 걸까?</h2>\n<p>여기서 궁금증이 생겻습니다. Static Html 인데 파일 시스템에서 router 동작이 어떻게 될까요?</p>\n<p><code class=\"language-text\">express/public</code> 에 있는 파일은 serverless 환경에서 돌릴 수 있는 순수한 Static Html 입니다.</p>\n<p>한번 웹 브라우저에서 해당 파일 경로로 파일을 열어볼까요?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACMUlEQVQ4y52SzW8SQRjG52biR5SDAjbyUUrlewoIaqv/g0cvQpNN+39w0IsNiRI1VkmKolZNkGCNu6wCwcSDNR68+MGlamoRaNOwdLvssPs6S5HEQxPgSX7zvJN38mTeySDzMeuRsM9+BU/huelzFxmvL8B4cYCZsJ9mTGYLY7ZYGYuGeZzWNsZk0vY2xmK1MdZxe48Jxj7pnHO5fWZkPmn14XAQgjMzcOb8BQgGwxAOTYPHFwSnC3eZpNhdPlp7weP1g4O6ze4Ah9MNfn8IXC43nA1hcDmds2iemceLj1JC6tljNfVkmaSWlsjT9DLh+ALh8kXCcQWyQn2F7lmWI/ybAnnN5gmb56lzhOW6LnMsC7FYLILuLd7Fze1tUdqVoCPLiiRJqtSWVAAYhg4FWJaNoBfpJH7/vSqmP/wCQSJaE1S6djqdQVEVKlEUIZPJRFGGBn5a+yO+/LwBrV6gQhNVtVv2fT+pewe0ySCbzUbR9YUEFjbb4v/9wfUvUJZl4Hk+ilLJJL7/7qcYL61BpSH1bzhsICEESqVSFH3l0vjhx3Xx0oNvQCdWBxlzv8BisRhFdxK3sCDsik15r6+MOHI/8Eb8Nm40xJ2dNgHSURR1eCnat9HekAZG0PN0curtl9/tq1wFNnrXHFXlcnkW3YwvuBOvVmvXsqti5ce6sLXZaNVqtVa9Xh8UgdKsVqtyLpe7jA4fOnhgzGj0HD+hD54aM/r1en1gFAwGg1+n0x39Cw1GWuS5KPejAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/88a8c3854fe7732e9ac306e394d4c1d6/c1b63/1.png\"\n        srcset=\"/static/88a8c3854fe7732e9ac306e394d4c1d6/5a46d/1.png 300w,\n/static/88a8c3854fe7732e9ac306e394d4c1d6/0a47e/1.png 600w,\n/static/88a8c3854fe7732e9ac306e394d4c1d6/c1b63/1.png 1200w,\n/static/88a8c3854fe7732e9ac306e394d4c1d6/d61c2/1.png 1800w,\n/static/88a8c3854fe7732e9ac306e394d4c1d6/97a96/1.png 2400w,\n/static/88a8c3854fe7732e9ac306e394d4c1d6/3a4f1/1.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>짠, 뭔가 나오긴 하는데 대충 봐도 css가 모두 깨져있는거 같습니다. 원래 해당 앱은 아래와 같이 렌더링 되어야 하거든요</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC/ElEQVQ4y2VRS09TQRi9O9mAFAzFDdAWKC8pLU8TYuIPcO9GwDTERJf+AdywlecC1yZiQltq6a0EqcRgDAuEhSImRB5tKUKLfdze19w7n99MC0qY5GS+OTPfmTNnhHqLvXygy/nI7XGP3hu87+3uGfC6e/q8Tmeb12ZzeG32Rq+jBLujCbl/s83eVEKjt6m5dbStvbNeqLvd0Nne3QWu/j7ovTsIbncPtDrvgL2xBeptzWCzO6GOoxkabI1gd2Bd7wCboxlaWjvwfC+0tbVDf68L59YR4dmTpy7/cjgfjq7Q8MoKiYRFIgbDZElcJoGgSHy+EJn3L5G3iyGy4PORd6EwCSLCYgTPREg48p7VuiiKMDb2YkiYezXnoqYpQ3GYCHoBRZFp6uyUZs5TNJ/9g/UZLRQK9P8zJRisORKJDAmTk5OuXC4nm6YBBiEUAUTXQVVVPis6gUxB42C1frFHdA5V06hhGKYkSeDz+YaFiYlJFzqRDbxncTtBN/bT3KqOwqZhgIaeh9/swOP5H6BjzTi2x8bnvRTMrO0xhya7xOf3lwTlomBgK0G//CoKEoJipcbQbhbEn1leM46UeP9WAl5vHHFBRVEgEAgMC1NTUy7MhWeoqSplDoqCBPApPCC0xcHDQu5CUFY1kBWFC2qaBqurq0XBXDYrs2zwFsqss80LqAzIqapylUcxihmCoVNN1018JESj0asOKQ7TNIGB8KcZjAQN8zD4f9ISX3S4d5qHzcPzS4dc8GUxwwJrSmZkMyNrvBWbOFi9eZCm698PL3mMhWrEpM8XtumD2XVz71QywCSwvPJhSJienunSdZRnP0vh2mCJ7sRS8HX34Np+6NtvmP20DwVumEL049qIMD4+3h6Px0/T6bSciMfzyWRSSqVS0snJCQerj2JxKZFIXOHP02np+DghxWKxfOY8nTtOJvVgMPhQKCsru1FbW9thtVq7yysq3FVVVR5ce3DNweoqi8VTXV19ha+x1nosyFsqKz23atg5qxvXN/8C9s5OEfHU4uIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/6e7bc13f386c737ed9c0b1b3807374a4/c1b63/2.png\"\n        srcset=\"/static/6e7bc13f386c737ed9c0b1b3807374a4/5a46d/2.png 300w,\n/static/6e7bc13f386c737ed9c0b1b3807374a4/0a47e/2.png 600w,\n/static/6e7bc13f386c737ed9c0b1b3807374a4/c1b63/2.png 1200w,\n/static/6e7bc13f386c737ed9c0b1b3807374a4/d61c2/2.png 1800w,\n/static/6e7bc13f386c737ed9c0b1b3807374a4/97a96/2.png 2400w,\n/static/6e7bc13f386c737ed9c0b1b3807374a4/3a4f1/2.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이외에도 link인 파란색 글자를 클릭해보면 아래와 같은 화면이 나오면서 정상동작 하지 않는 것을 확인할 수 있습니다. url 경로를 보더라도 에초에 존재할 수 없는 경로로 요청을 보내는 것도 확인할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABuUlEQVQ4y6WS32/TMBDHU4rEE/DSlW1N7PxomtRO4sRuB6EQOiEh/gReGJOi/fM8MqjEvOY4mwB7WNkKDx/dnc/3te90jvuEPFY8/JgX+cWqbtq6ft1KddJSGrSuR1uP+C0htCWej/6fM9el6Pu/CcLpRZIy6kxpXCxWL6A+XcOr9Vt417yB980p1OoE0nlhiQ2sgCTlwLiAZJ7BHGNRSni5akCpBayb51CW4twhEyrYUl3y5aLjcqFFJnSVSV2US80ypRmXOkY7y6Wes1xnhdQpK9BWmuelzoVEK66qSkEUxWfO6GAsPNffEC8AQoKtR8LOo0GH7XWEhhZs32JjcsOS/h4Jr10SwOHR5MwZjw8F9aONH0wB6dCHEl8LoxngZaA0gj63iw7ZGv944n1yDm4RTHFG2A7OKbeYnDm/TRDPraDJHx3vEJwlDHBGFp4JCML4/wRNu/GMQTRNbhbuL9gnbTEO3tpf7BK9U/AvP7nvD58ZwW99ctuL7oOpuf4p6Nq1KTH4fsdq3Atcm3NnNBpz3LfPOLMNocEl8nVPTM0X5AoX+4MzGAweDYcPM0QhFSL/kerBcPj0B+rtUqGG5pOzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/aeb2e6de6ef9e1a1a9195e290bf027e0/c1b63/3.png\"\n        srcset=\"/static/aeb2e6de6ef9e1a1a9195e290bf027e0/5a46d/3.png 300w,\n/static/aeb2e6de6ef9e1a1a9195e290bf027e0/0a47e/3.png 600w,\n/static/aeb2e6de6ef9e1a1a9195e290bf027e0/c1b63/3.png 1200w,\n/static/aeb2e6de6ef9e1a1a9195e290bf027e0/d61c2/3.png 1800w,\n/static/aeb2e6de6ef9e1a1a9195e290bf027e0/97a96/3.png 2400w,\n/static/aeb2e6de6ef9e1a1a9195e290bf027e0/3a4f1/3.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이에 대한 이유는 export된 파일의 <code class=\"language-text\">index.html</code> 을 열어보면 알 수 있습니다. 아마 대충 아래와 같은 형태를 가지고 있을 것입니다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">data-href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://fonts.googleapis.com/css?family=PT+Sans:300,400,700,800<span class=\"token entity named-entity\" title=\"&amp;\">&amp;amp;</span>display=optional<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>preconnect<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://fonts.gstatic.com<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">crossorigin</span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>next-head-count<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/_next/static/css/8964a576241b890e8a20.css<span class=\"token punctuation\">\"</span></span></span>      <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>style<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/_next/static/css/8964a576241b890e8a20.css<span class=\"token punctuation\">\"</span></span></span>      <span class=\"token attr-name\">data-n-g</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>noscript</span> <span class=\"token attr-name\">data-n-css</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>noscript</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span>\n      <span class=\"token attr-name\">defer</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">nomodule</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js<span class=\"token punctuation\">\"</span></span></span>    <span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    ...\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>보니까 각종 css 및 script에 대한 정보를 <code class=\"language-text\">/</code> 경로로 요청하는 것을 볼 수 있습니다.</p>\n<p>당연히 <code class=\"language-text\">/</code> 하위 경로에 해당 파일이 없을 테니 css가 깨지는 것은 당연합니다.<br>\n한번 <code class=\"language-text\">index.html</code> 만 <code class=\"language-text\">/</code> 으로 되어 있는 부분을 모두 <code class=\"language-text\">./</code> 으로 변경하고 다시 열어볼까요?</p>\n<blockquote>\n<p>Editor에서 <code class=\"language-text\">/_next</code> => <code class=\"language-text\">./_next</code> 으로 찾아서 변경하면 편리합니다.</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAADBklEQVQ4y2VRS08TURidnWxECsZ2I+VhRWhlOoMNaEj8Be7dCJqJMdGlfwA3bOWhC12b6MKCBTqlIo8YjGGBuvCZEHm0pVA6UMp0Xnfmfn73thiJNzn5vnvufOeee0YI+tpO90U7bkmydLf/2nVFjPYootSjhEIdSrC5RQkGW5XWGoLBNqW5GfuWdqWltV1pbQvVcEEJXey82xXuDgrnA8HuyBUJon29IMWuQq8oQb8cgxhWOSxCT0QECSGGu7G/DLHuKMhdEbgUugQdnRGQpBh0dYWhNyZi7bwtPLh3X5xIq0fJxTk683aOzCZVMpdMk9n0PJmZSZOphEpeT6VIfFoliTcJkkrNElVFYJ1JpkgSa1JNOaqqwtDQowHh2fNnIvU8A6rLQ9BjGIZB9/Z26YG2R8ulA7pXKFBd1+m/39TgsuFUKjUgjI6OiuVy2fA8F1xCKAKI44BlWbyajgulis3Beuf4jDgclm1T13U9vAji8figMDIyKpqmYbh4z5svObqyrnGrDgp7rgs2eh58+R3uvPoBDvaMY2dsfVgrwpOlNebQY5fEJyZqgkZVcPJzjn78XRUkBMVqg9M/D0H9dch7xpEaP/E5By9WtrigaZowOTk5KIyNjYmVSoVnaFsWZQ6qggTwKTwgtMXBw0LuWNCwbDBMkwvatg3z8/NVwfLhocGywVsos84Oj2ExIGdZ5kkexShmCK5Dbcfx8JGwsLBw0iHF5XkeMBD+NJeRYGMeLv+ftMZXHa4VjmB1c/+vQy74uJphhQ3lS4ZXMmw+ikMcrF/d0Ojyt82/PMZCbeLRh6+/0BtPl721gu6CRyA9925AGB9/EnUclGd/lsJ/iyX6PVOETz83/juf/roLT9+vQ4UbprCwuHRbGB4eDmez2YKmaUYumz3K5/N6sVjUd3Z2OFi/lcnquVzuBL+vafr2dk7PZDJHpX2tvJ3PO4lE4qZQV1d3KhAIRPx+f8/p+nqpsbFRxr2Mew7WN/p8clNT0wn+nD8g+5D3NTTIZ8+x7/wS7s/8AQ11T2gZqdF+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/8a2bbc502e2ee31b7f12809548f56ed5/c1b63/4.png\"\n        srcset=\"/static/8a2bbc502e2ee31b7f12809548f56ed5/5a46d/4.png 300w,\n/static/8a2bbc502e2ee31b7f12809548f56ed5/0a47e/4.png 600w,\n/static/8a2bbc502e2ee31b7f12809548f56ed5/c1b63/4.png 1200w,\n/static/8a2bbc502e2ee31b7f12809548f56ed5/d61c2/4.png 1800w,\n/static/8a2bbc502e2ee31b7f12809548f56ed5/97a96/4.png 2400w,\n/static/8a2bbc502e2ee31b7f12809548f56ed5/3a4f1/4.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이제 css 파일이 깨지지 않고 정상적으로 렌더링되는 것을 확인할 수 있습니다.\n하지만 여전히 router 기능은 동작하지 않는 것을 확인할 수 있습니다. 왜 그런 것 일까요?</p>\n<h2 id=\"express-server\" style=\"position:relative;\"><a href=\"#express-server\" aria-label=\"express server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>express server</h2>\n<p>사실 기본 옵션으로 <code class=\"language-text\">next export</code> 되었을 때의 경로가 <code class=\"language-text\">/</code> 으로 설정되어 있다는 것과 link시 이동되는 경로도 <code class=\"language-text\">/</code> 를 기준으로 하고 있는 것을 보면 결국 리소스 탐색을 위해서 <code class=\"language-text\">basePath</code> 가 필요하다는 것을 알 수 있습니다.</p>\n<p><code class=\"language-text\">basePath</code> 지정하는 가장 쉬운 테스트 방법으로 web server에서 static file를 서빙해주는 것입니다.</p>\n<blockquote>\n<p>도메인 자체가 리소스의 <code class=\"language-text\">/</code> 이기 때문입니다.</p>\n</blockquote>\n<p>중요한 것은 next.js server 이외에서 돌아갈 수 있는 것입니다.\nstatic html을 클라우드와 같은 static web host에 push하고 사용할 것이기 때문입니다.</p>\n<blockquote>\n<p>사실 export된 static 파일을 파일시스템에서 돌려볼 일은 없을 것입니다. 그럼에도 넣은 이유는 메커니즘에 대한 설명을 위한 것이었습니다.</p>\n</blockquote>\n<p>이를 위한 테스트를 위해서 <code class=\"language-text\">express</code> 에 express server 코드를 작성해 놓았습니다.</p>\n<blockquote>\n<p>일부로 express 코드도 공식문서와 동일하게 맞춰놓았습니다. 코드 리딩이 쉽도록요!</p>\n</blockquote>\n<p>아까전에 <code class=\"language-text\">index.html</code> 경로 수정해서 찝찝하므로 다시 <code class=\"language-text\">next export</code> 후 <code class=\"language-text\">express</code> 디렉터리에서 <code class=\"language-text\">npm run start</code> 를 실행해서 서빙되는 정적파일이 잘 동작하는지 확인해봅시다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACNklEQVQ4y6VSy27aQBT1rmyqihVUagOGGAKkGIJIUCqqSP2JbkoiWVlUykekS3YBFmz4BEDlZTtUqsSnVCpCGCgJOMZm7LmdsU2FUCq16UhH586dO+c+ZpiAN/Q8l4p+TB+lL/Nvz4R3Z++F3Gle4LiowLJhIRTeF8IhB6FwhPgoczazIc7FvsBFYpfxRDLA7L0MJhOZFKRyJ5A9zcPxcQ5SyQxEDt5AkI1CIMjBazYCr1iO2GFgQxHYoxyOwEHsENLpLMTjCTjJ8oRjF8zVpyv+y1d52fvWx53bPpJFCckdCfWkPup0CToyanZvUbMno3a7g3qijFrtns1dkcbJxJbWoijC9fXnAlOr1XgA0AADrA3dIjZ+AkwCIKIFplQq8fP5XKMOC2NsmhYYhgEIITBN829AbmFLVVWo1+vnzM1NiV8sFo4gVST5aKBt0PSUN9ha1O+CHlir1QqazeY5Uy6X+fndneYG2ae7gnhLjNrIsrbPdgUr/HQ207Db8m6F7ihAWejwg0zm++wBlKX+Z8FKpcL/dGeIHxXEdreaYcJMNWCpI9CRSar83cG/CjoVbvbWpl3CFo1zXtkWbDQajuD9/eIBO49ivwtCJjGcAWB3rxtr26dqK2zHGAZe6zpNQzOYuq6DJEkFplqtpsgXMeA/F618MBhcMMViMTEcDpXpdKpNFGU5mUzU8XisKoqiUnsXj/iX5O5iNBqtW63WB8bj8Tzz+/2HPp8vQ5AmOHoi0l6v98UvUPRfBi2Q3fcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/0400f73145cb3c701b9f4747a23e1fc9/c1b63/5.png\"\n        srcset=\"/static/0400f73145cb3c701b9f4747a23e1fc9/5a46d/5.png 300w,\n/static/0400f73145cb3c701b9f4747a23e1fc9/0a47e/5.png 600w,\n/static/0400f73145cb3c701b9f4747a23e1fc9/c1b63/5.png 1200w,\n/static/0400f73145cb3c701b9f4747a23e1fc9/d61c2/5.png 1800w,\n/static/0400f73145cb3c701b9f4747a23e1fc9/97a96/5.png 2400w,\n/static/0400f73145cb3c701b9f4747a23e1fc9/3a4f1/5.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>next.js server 이외 다른 server에서 css 및 router가 정상적으로 동작하는 것을 볼 수 있습니다.</p>\n<blockquote>\n<p>만약, 도메인의 하위 경로를 바꾸고 싶다면 <a href=\"https://nextjs.org/docs/api-reference/next.config.js/basepath\">basepath</a> 를 참고하세요.</p>\n</blockquote>\n<h2 id=\"숨겨진-router의-원리\" style=\"position:relative;\"><a href=\"#%EC%88%A8%EA%B2%A8%EC%A7%84-router%EC%9D%98-%EC%9B%90%EB%A6%AC\" aria-label=\"숨겨진 router의 원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>숨겨진 router의 원리</h2>\n<p>맨 위에서 부터 첫 페이지 요청만 html 파일을 받고 이후에는 CSR이라고 설명했었습니다.\n다시 한번 export된 파일의 구조를 한번 봐볼까요?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 205px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 333.6585365853658%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/1b6e49e68626076a44e776df444017ec/85860/6.png\"\n        srcset=\"/static/1b6e49e68626076a44e776df444017ec/85860/6.png 205w\"\n        sizes=\"(max-width: 205px) 100vw, 205px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>만약, <code class=\"language-text\">http://localhost:3000/project/facebook-react/</code> 경로에서 새로고침을 한다면 어떤 html 파일을 받아와야 할까요?</p>\n<p>next.js server 이였다면 똑똑하게 이 요청은 <code class=\"language-text\">project/[path].tsx</code> 경로야! 하면서 SSR 이후 파일은 반환해줄 것입니다.</p>\n<p>하지만 위의 테스트 시나리오는 next.js server 이외 처리되었습니다. 때문에 요청하는 경로에 파일이 없으면 그냥 없는 것입니다.</p>\n<p>이를 위해서 <code class=\"language-text\">next.config.js</code> 파일을 보면 <code class=\"language-text\">trailingSlash: true</code> option 처리가 되어있는 것을 확인할 수 있습니다.</p>\n<p>웹 개발자라면 새로고침을 하더라도 위 캡쳐사진의 파일 하이어라키 덕분에 정상적으로 router 되는 것을 확인하실 수 있습니다.</p>\n<blockquote>\n<p>모르겠다면 댓글주세요. 🤗</p>\n</blockquote>\n<h2 id=\"생성되지-않은-동적경로의-경우는\" style=\"position:relative;\"><a href=\"#%EC%83%9D%EC%84%B1%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%80-%EB%8F%99%EC%A0%81%EA%B2%BD%EB%A1%9C%EC%9D%98-%EA%B2%BD%EC%9A%B0%EB%8A%94\" aria-label=\"생성되지 않은 동적경로의 경우는 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>생성되지 않은 동적경로의 경우는?</h2>\n<p>동적인 경로의 경우 <code class=\"language-text\">getStaticPaths()</code> 으로 생성되지 않았다면 어떻게 될까요?</p>\n<p>제가 예제 코드에서 <code class=\"language-text\">http://localhost:3000/post/[id]</code> 경로의 경우 동적 경로이지만 <code class=\"language-text\">getStaticPaths()</code> 으로 생성되지 않은 것을 확인할 수 있습니다.</p>\n<blockquote>\n<p>export 결과물을 보면 아래와 같습니다. 이러면 당연히 새로고침하면 문제가 발생하겠죠?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 244px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.52459016393443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz11Sy07DMBDsP/Bok+ZJ0jqJXefVqoU+RFVVoCJxhEuFhMSBG2fER/AD3BFnPnBYOySEHkbrHcezs5vtGFaCHsG0OdS5azD0+nGTt6G4GlVecX1HNLETDEuEbAzLFdjdP+F2/wyer/QHfjiGF5QaAZvB8TPNhdGM8ilYsoDlyUZMC8p8iclso109vLzh/esbu7tHWPYIxfQGo3wLWWyRja/hDyZajKdrpOUVRLaBc5bDJLe1y067JSYuwMs1un4Ow03hBgU5l7C9lFBFlwS8X165tVsOtWBtVeHUjOGYA8z9ENKjWVpcV+/1IyoYw6Au6nPDay7+m2EtZjkcx9TmMmD4LI7wyk0cOxIRX2CYzBGJFRJ5qc/KIeNLnUcU1Z3KVZcthxxdWyDxYnxkJ9gzlwpIxKJ6qOal5jaieTIqMojP9SzVnRYWB4KmXYkaFF2HN5zZWpnD9fm/UtWP+QFKd+v4xJGFzAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/73f281c5758b5fbe47d5c49eebb50e41/0cba8/7.png\"\n        srcset=\"/static/73f281c5758b5fbe47d5c49eebb50e41/0cba8/7.png 244w\"\n        sizes=\"(max-width: 244px) 100vw, 244px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</blockquote>\n<p>한번 해볼까요? express server를 시작해서 아래의 영역을 클릭해서 들어가 봅시다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACnklEQVQ4y5WSTU8TURSGZ+nGUF21gkCntKV8OLRQwISY+C/cCCSTasI/YWUpG1iL0Zi0sR3aGQg2ccVfMBoTK21TbKEf8z13Zo73TCmhqAtO8uS9c3Lvec89d5iJB+z91YXoy3ginnq29pxfXFrlE0vLfDQ6wwfZEM+GpvgQ24cNRfhgEDXsaZANXzHFhyOx1OzckwlmPDD5ZHZxAbiVZUg+XYN4fAli0Xlgp6ZhYjJMicBYEMF1CIJsBMZRQxGYjs3R/UmYmZmFlSQHsdj0JrP1eov7dCzK0peyK34uE6kkEkkQSVE8JgXhiAiCRHKHRyRXlEihIJBiSSL5QtHTwxLuk0ixWLIkUYTt7e11Zm9/nwMAzSE26JrmyLLs0u+7YlPg9PR0nUmn05ysyBqxCZim6VqWBYQQQNV1nWLcQAfDMG7j0nOOqqpwcnKywWQyGY5+aOjg9gPVK2rbNjiOMwTmBqZXxi5VB83K5fIGs7u7y3W7XY26YAduvyvdO0SvD61WCzqdjke73QZFUa5vcMXfBelBDd0tQtyBM3aCRer1OpydnUGj0fAUDby9/y2Y2eFaPU1TTAdUzXIVzYKeQdcmoVd34HYMxoE6SFG8goIg0BnupLnfPV3rqRb8+Flzaw16RZWAYtL50S7xYLPZhIuLi6HZYuAIzs/Prwtms9kNZif9hmu0FRWLNC9l57KruR3dcRXDdh2bYB/48h7YDemPxVtjDl8YfxssmMvl1pn9vb0FxQITPTW6TaELmWLYcKfAeebz+U0mlXo1//bd++aHj1nj67fvcrVWVyq/qgpqvVZTqtXqEDWaow91MyfTXK9SqVgHBwcvGBr3KBwl+dA3kng8NpoYfRRIBAL+hN/vpxoYAnP/ylPiPp9v5A+BSlVRBPK15QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/1505010ea80d0bfb4ea2bb1510f53ecd/c1b63/8.png\"\n        srcset=\"/static/1505010ea80d0bfb4ea2bb1510f53ecd/5a46d/8.png 300w,\n/static/1505010ea80d0bfb4ea2bb1510f53ecd/0a47e/8.png 600w,\n/static/1505010ea80d0bfb4ea2bb1510f53ecd/c1b63/8.png 1200w,\n/static/1505010ea80d0bfb4ea2bb1510f53ecd/d61c2/8.png 1800w,\n/static/1505010ea80d0bfb4ea2bb1510f53ecd/97a96/8.png 2400w,\n/static/1505010ea80d0bfb4ea2bb1510f53ecd/3a4f1/8.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>정상적으로 나오는 것을 확인할 수 있습니다. <code class=\"language-text\">express/public/index.html</code> 의 파일을 받아서 CSR 처리를 통해 router 되었기 때문입니다. 이제 여기서 새로고침을 하면 어떻게 될까요?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABz0lEQVQ4y62SzW7aQBSFZ1c2VcUKqapKbIODA43tNBaJRKL2LbIpiWSlfRCkICFW/DxEN1GDf5NKgNjxFIloEcTs6mLAY/t2hpJVu6iTXunTGc+dc3Q9NkonmecHEv9BkqXz49J7tXT0Tt3bL6rb24LKsJzKchmVY3/DcrzKMFSza2XY7IaMmuWF83xhN43SL5ndwr4M0kERlMMSKEoR3uRlYDM5eL2VhfQWD68YCl1zwLA82SfK8ZATCiDLCuzs5KGoiCAIuTP0Sf0ofta/uFc3VqTffMWmYWCrY2LdvMaaTtBsfEn00rBxp6Nhw7TxVcdYq25a2LBsbBimb9sW1Gq1MrqoXojjb9+92b0DpEJC9AgCah4Oh2VUqVTE27s7z3EcmM/n0XK5hJhEq9UqJF7odrunqF6vi7PZzCMFpBFhjMH3faD6L5Cz1BPS8H6/f4parZZI0r0oitbNOGF/DWw0GqLrul4QBA/Np03YbDb/CHzShP89cPPK801guLnHOIQkMFgsFtDr9cqo3W5L5GFF/yP6YeLWg4dOOxgMzlC1Ws2PRiNnOp16k8nEJfyMiUu8P8bjsa9p2glKJBLPUqlUgfCWIBP2HomcTCZf/ALU7lsb9252LwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/3980f0ea13a2daea2d3e9c73e5ae4c66/c1b63/9.png\"\n        srcset=\"/static/3980f0ea13a2daea2d3e9c73e5ae4c66/5a46d/9.png 300w,\n/static/3980f0ea13a2daea2d3e9c73e5ae4c66/0a47e/9.png 600w,\n/static/3980f0ea13a2daea2d3e9c73e5ae4c66/c1b63/9.png 1200w,\n/static/3980f0ea13a2daea2d3e9c73e5ae4c66/d61c2/9.png 1800w,\n/static/3980f0ea13a2daea2d3e9c73e5ae4c66/97a96/9.png 2400w,\n/static/3980f0ea13a2daea2d3e9c73e5ae4c66/3a4f1/9.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>아래와 같이 요청한 경로에 리소스가 없기 때문에 새로고침에 실패? 하는 것을 볼 수 있습니다. 만약 next.js server에서 해당 경로에서 새로고침 했다면 정상적으로 동작했을 것입니다. next.js server는 해당 경로가 어떤 리소스를 필요로 하는지 알고 있기 때문이죠</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABkUlEQVQ4y+2SsU7CQBzGb5PFGCYwIUBbKCDIcRVE3sRFMGlMTHwSEjYgDPoCbhJpaQsLEDZegwFhEinBa+/vVYiTgxhHv+SX7/5393254VDELx4WsXxFFHKTV4rqKVZUJV9UE4mUKoiSKkoxVRK3iJLM9zyPq4IQ4+v4jpgqJ1I36Uw2gsLH0WwmT4CULoCclwBjBU7TORBjSQhH4xDhhKIyhIQ4hCMSCKL85clUBggpwMlJGoqFLKSSyWt0d3uHHzvt5ZOpMa3Xp5ZhUrNjUN3oUU3vU03r0adun7b53NF0apgWfda6n97ldw2z5/m7ZVlQq9XK6P7hHgMDG7ZyOewXOF54MpmUUb1ex6vVymaMgeM4jAN7whzXdTebDQwGgwpqNpt4vV5/vpB5rVuHn2qXcb3y0Wj0feE++i+soEajgW3bXu0OXba/vK/mUEphOByWUavVyvFhA3+g8Xh8jarVano6nb4sFgt7Pp8vOW974mVeZ7PZu67rl8jn8x0Eg8FMIBA44xCO8ht4B/H7/Ucfz11kM6TrAuYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"10\"\n        title=\"10\"\n        src=\"/static/1b2f7c7fffaae5fbf3e9dcbef559628f/c1b63/10.png\"\n        srcset=\"/static/1b2f7c7fffaae5fbf3e9dcbef559628f/5a46d/10.png 300w,\n/static/1b2f7c7fffaae5fbf3e9dcbef559628f/0a47e/10.png 600w,\n/static/1b2f7c7fffaae5fbf3e9dcbef559628f/c1b63/10.png 1200w,\n/static/1b2f7c7fffaae5fbf3e9dcbef559628f/d61c2/10.png 1800w,\n/static/1b2f7c7fffaae5fbf3e9dcbef559628f/97a96/10.png 2400w,\n/static/1b2f7c7fffaae5fbf3e9dcbef559628f/3a4f1/10.png 2588w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>사실 <code class=\"language-text\">next export</code> 으로 사용한다는 것은 블로그와 같이 정말 정적인 데이터인 경우 사용하는 시나리오가 대부분 일 것이기 때문에 이와 같은 시나리오의 경우는 매우 스페셜한 케이스라고 생각됩니다.</p>\n<p>중요한 것은 next.js server 이외 돌아가는 메커니즘을 이해하는 것입니다.</p>\n<h2 id=\"사용을-추천하지-않는-code-classlanguage-textexportpathmapcode\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EC%9A%A9%EC%9D%84-%EC%B6%94%EC%B2%9C%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-code-classlanguage-textexportpathmapcode\" aria-label=\"사용을 추천하지 않는 code classlanguage textexportpathmapcode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>사용을 추천하지 않는 <code class=\"language-text\">exportPathMap</code></h2>\n<p><code class=\"language-text\">next export</code> 와 관련되어 찾아보면 <code class=\"language-text\">next.config.js</code> 의 <code class=\"language-text\">exportPathMap</code> 옵션에 대해 그냥 써놓은 글이 많습니다.</p>\n<p>결론부터 말하면 이제 사용되지 않습니다. (사실 사용하는 법도 모르겠습니다) <code class=\"language-text\">getStaticPaths()</code> 가 동적인 경로를 반환해주기 때문이죠</p>\n<p>해당 내용은 <a href=\"https://github.com/vercel/next.js/issues/10983#issuecomment-597829065\">github issue로도 open</a> 되어 있는 상태입니다.</p>\n<p>이걸 왜 사용하는지 제대로 설명해준 사람도 거의 없고 공식문서도 아직 내용이 반영되지 않은거 같아 시간이 많이 소모되었습니다…😾</p>\n<blockquote>\n<p>에초에 동적 경로에서 <code class=\"language-text\">getStaticProps()</code> 만 사용하면 <code class=\"language-text\">Error: getStaticPaths is required for dynamic SSG pages</code> 가 출력되어 export가 안됩니다.</p>\n</blockquote>\n<h1 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h1>\n<p>사실 제대로 next.js를 많이 사용하고 공부 헀다면 이런 질문이 나오지 않을 수 있다고 생각하기도 합니다.</p>\n<p>하지만 그럼에도 불구하고 next.js의 SSR을 햇갈려하는 글은 간간히 보이는 걸로 보아 나만 그런건 아닌가 싶은 안심이 들긴했습니다.</p>\n<p>특히, jsp와 같은 Server Side Script 언어와 대조를 하다보니 더욱 더 햇갈렸습니다.</p>\n<p>보통 블로그와 같이 정적 웹을 만든다고 하면 <code class=\"language-text\">Gatsby.js</code> 가 주로 생각나고 많이 사용되는 것으로 알고 있는데 차란히 next.js로 SSG, SSR을 모두 처리하는게 더 좋지 아늘까? 하면서 더 궁금해서 SSG를 더 깊이 공부하게 된 거 같습니다.</p>\n<p>해당 글이 next.js의 SSG 이해에 도움이 되셨으면 좋겠습니다. 언제든지 질문과 피드백은 환영합니다. 읽어주셔서 감사합니다.</p>","frontmatter":{"title":"next.js의 SSG 제대로 이해하고 사용하기","date":"September 07, 2021"}}},"pageContext":{"slug":"/next.js/lets-properly-understand-and-use-the-ssg-of-next.js/","previous":{"fields":{"slug":"/devops/workflows-with-aks-github-slack-7/"},"frontmatter":{"title":"aks, github, slack으로 워크플로우 구축하기 - 7편 (회고)","category":"devops","draft":false}},"next":{"fields":{"slug":"/essay/share-react-boilerplate-with-gin/"},"frontmatter":{"title":"gin과 함께하는 react boilerplate를 공유합니다","category":"essay","draft":false}}}},"staticQueryHashes":["2486386679","3128451518"]}