{"componentChunkName":"component---src-templates-blog-post-js","path":"/azure/how-is-k8s-external-ip-handled-in-azure/","result":{"data":{"site":{"siteMetadata":{"title":"Parkgang Dev Log","author":"parkgang","siteUrl":"https://parkgang.github.io","comment":{"disqusShortName":"","utterances":"parkgang/parkgang.github.io"},"sponsor":{"buyMeACoffeeId":"parkgang"}}},"markdownRemark":{"id":"70c849ba-1ab2-575b-a193-0fd081e8348c","excerpt":"Overview Azure에서 AKS를 사용하면서 문득 이런 궁금증이 생겼습니다. ingress를 통해 외부의 트래픽을 받아오는데 ingress IP은 어디서 생성되었으며 어떻게 Load balancing이 되는거지? svc를 LoadBalancer으로 생성하는 경우 IP가 생성되는데 어디서 생성된거지? 해당 IP는 어떻게 Load balancing 된다고 장담할 수 있는거지? Azure에 k8s cluster를 올려놓고 k8s의 spec…","html":"<h1 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h1>\n<p>Azure에서 AKS를 사용하면서 문득 이런 궁금증이 생겼습니다.</p>\n<blockquote>\n<p>ingress를 통해 외부의 트래픽을 받아오는데 ingress IP은 어디서 생성되었으며 어떻게 Load balancing이 되는거지?</p>\n</blockquote>\n<blockquote>\n<p>svc를 LoadBalancer으로 생성하는 경우 IP가 생성되는데 어디서 생성된거지? 해당 IP는 어떻게 Load balancing 된다고 장담할 수 있는거지?</p>\n</blockquote>\n<p>Azure에 k8s cluster를 올려놓고 k8s의 spec에 맞게 <code class=\"language-text\">.yaml</code> 을 적용하면 예상하는 대로 동작이 되어서 Azure가 핸들링 한건지 k8s가 핸들링한건지 큰 관심을 안가지고 있었는데 AKS 관련 내용을 정리하다가 갑자기 궁금해져서 간단하게 찾아보고 정리하려고 합니다.</p>\n<h1 id=\"리소스-관련이므로-azure가-하겠지\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EC%86%8C%EC%8A%A4-%EA%B4%80%EB%A0%A8%EC%9D%B4%EB%AF%80%EB%A1%9C-azure%EA%B0%80-%ED%95%98%EA%B2%A0%EC%A7%80\" aria-label=\"리소스 관련이므로 azure가 하겠지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리소스 관련이므로 Azure가 하겠지?</h1>\n<p>IP 생성이랑 Load balancing 이부분은 리소스를 제공하는 Azure만 핸들링할 수 있다고 생각합니다.</p>\n<p>그렇다면 어떤 리소스 타입으로 핸들링하느냐를 찾아야하는대 생각보다 쉽게 찾을 수 있었습니다.</p>\n<h1 id=\"부하-분산-장치와-공용-ip-주소\" style=\"position:relative;\"><a href=\"#%EB%B6%80%ED%95%98-%EB%B6%84%EC%82%B0-%EC%9E%A5%EC%B9%98%EC%99%80-%EA%B3%B5%EC%9A%A9-ip-%EC%A3%BC%EC%86%8C\" aria-label=\"부하 분산 장치와 공용 ip 주소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>부하 분산 장치와 공용 IP 주소</h1>\n<p>AKS를 생성하면 자동으로 <code class=\"language-text\">부하 분산 장치</code> 라는 리소스가 생성됩니다.</p>\n<p>또한, ingress를 설치하고 LoadBalancer type svc를 생성하다 보면 리소스 그룹에서 <code class=\"language-text\">공용 IP 주소</code> 라는 것을 쉽게 찾아볼 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 121.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAAErklEQVQ4y21Uy27bRhRlgtQO7MgixYdE8TlDckiRelhyFbuI5SS2EySpkF8p2mX3VtFdEmSRb+svVK1QdFdFvD0ztpwHsjgYPmbO3HPPvVezG97eKIl/zfrl79OHs6uTk7PF8exiUY2+X0RxumBMLBi/RswyIF/EvFgEcbYIo2Th+ZHEb54fXgGx5jtBfHJ2+vH0+TM6PX9Fw+PHdDiYUl4eUSgmFKQj8pOhQpAdUpgOKGA9KvpTOpw+ptnZU3ry5IIenz8nztPXmtkw2PTibPnD+RkdPXz43+X8x/Wr2Wz94tmL9dnly/WjJxfr2dNn69n5c/U+HE/Wg8Fg/eh0tq6GYzyP1mEUr5Mk3di2M9c832UiTVcBLyhN002WJLUoijrL0jrlTKHTtmvbMhUMQ691Xa+bzSZwUDcajXpvb6/e39+nBw/251pWDdlgerxK8pyqqtpkWUYSnCdUFDkVvZLaHZecdptsB7AdauO53e7gG+A4tW3btWmaBPK5FsUBm0wnq5NHpzSZTDa9Xo/KskdIMPGsRxYILMumTqcD4o4i73rhzTsukmROt+apoF9+/mmulWWfDUZHq0RUlAuxMU2L9GaTvCAing9UZPKwZVmQ9IBMrEGc0sHBAUE2SfmQW0tVHz58mGvVuGSjo8EqjmLI5BspR26WksKIgaxNvh+Q67qK2Aahi7XVapFhGHKtcVGN/NObN2/mmqhCEBYr3/MIedjITYauk4z0JkcyN+oSSYqIbqPbEkpjJOHbt2+RQz9gRZ6vYs5vCeUhG0RBGCmSbrdLcRxTF88Mq+97arVtS0neRvju3bu5xqKA5UW+SotSytk0QaarCE3K4TxPOFxPZUkRYwxpiFRe5QVJkiiXZQkJkUEyIuRxyGDGKmKpTPxGkklSB7dXcNxtu2SbNpkti1p6izzkNHA71EDd+UEg86pMSWHKteQwhGSxSlKOn+6NZIM6IEyykiI/oTgUFPucfKdDWeDRUS+nrmVShChxXkkWIr8mZBFjeZ6tuAhJZALtY6uyaUGyw1HUUQX0yAkEGS1T5bTq95VskFF4Q5h9IoRkRCggL0HZbE1ptQxyo4TafASynFqWQ03883yfemWF/6bKIfIKyYgwL64J4+haspAGgFBGKHPo2i0aloJ4XEIuo8BqUVdvUA7Jx1VJVvOAEmVUrHJ4S8iiSEUY84jaTnsj5UpCzzYxokaQVFAYZHC1RBkVVKQFTauCOiDkiBBu13uyU8Q2QmlKAcKUoc66ty5LU1g1pm7cxyw8xFyckJeMKRV9KhJGJgils/xryTz0GcbVivcPKUuTjX6TQ9NEiaDmXLjsergMLrsep8ALqNt20E1NaQiK3P/SlMj3EGGxKkdjSAsUobEFjNFlzwK6sYVBn/bocv2yU6Jrl/8WQsg5+BEbpNNS+gYdoKDrTfX+Lci9INzc9jKPI45e/hdjXLWWlLuNUE4XORzk6DI+j/wryLEmCd+/f/9a87xugNz9gQnyD6bGn4houQWIlujpJQ4tP//+ORDAEmXzF9xeXl1dXWp37tz57v79+72dnd2j3Z2d8b17926haZrC3bt3v/j+DUx2d3eHmEr7/wNfhFLgamiKCAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/c2bc5a3962b2dfa04c9cf0715de77416/c1b63/1.png\"\n        srcset=\"/static/c2bc5a3962b2dfa04c9cf0715de77416/5a46d/1.png 300w,\n/static/c2bc5a3962b2dfa04c9cf0715de77416/0a47e/1.png 600w,\n/static/c2bc5a3962b2dfa04c9cf0715de77416/c1b63/1.png 1200w,\n/static/c2bc5a3962b2dfa04c9cf0715de77416/d61c2/1.png 1800w,\n/static/c2bc5a3962b2dfa04c9cf0715de77416/8c5dc/1.png 2384w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>결론부터 말하면 <code class=\"language-text\">공용 IP 주소</code> 가 하나의 IP 주소에 대한 리소스이며 k8s svc의 <code class=\"language-text\">EXTERNAL-IP</code> 를 의미합니다. <code class=\"language-text\">부하 분산 장치</code> 는 여러개의 <code class=\"language-text\">공용 IP 주소</code> 를 IP 구성으로 가지고 있습니다.</p>\n<p>그러면 ingress가 생성되거나 혹은 LoadBalancer type svc가 생성되는 것처럼 <code class=\"language-text\">외부 IP가 필요한 경우</code> Azure가 알아서 <code class=\"language-text\">공용 IP 주소</code> 를 생성하고 <code class=\"language-text\">부하 분산 장치</code> 에 바인딩 해주는 거라고 생각할 수 있습니다.</p>\n<blockquote>\n<p>이러니까 이해가 되네…</p>\n</blockquote>\n<h1 id=\"실제로-그런지-확인해보자\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%A0%9C%EB%A1%9C-%EA%B7%B8%EB%9F%B0%EC%A7%80-%ED%99%95%EC%9D%B8%ED%95%B4%EB%B3%B4%EC%9E%90\" aria-label=\"실제로 그런지 확인해보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실제로 그런지 확인해보자</h1>\n<p>실제로 그런지 한번 확인해보겠습니다. 위의 캡처 사진은 belf project에서 사용된 리소스 그룹을 캡처한 것인데 외부로 노출되는 svc는 모두 <a href=\"https://github.com/belf-kr/infrastructure-as-code/tree/v0.3.1\">belf-kr/infrastructure-as-code</a> 에서 소비되고 있었습니다.</p>\n<p><code class=\"language-text\">.yaml</code> 을 읽기 귀찮으신 분들을 위하여 외부로 노출된 svc를 나열해 드리면 아래와 같습니다.</p>\n<table>\n<thead>\n<tr>\n<th>ns</th>\n<th>name</th>\n<th>이유</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ingress-basic</td>\n<td>nginx-ingress-ingress-nginx-controller</td>\n<td><a href=\"https://docs.microsoft.com/ko-kr/azure/aks/ingress-tls\">HTTPS 수신 컨트롤러</a> 를 사용하기 위함</td>\n</tr>\n<tr>\n<td>qa</td>\n<td>mysql-lb</td>\n<td>qa 환경 mysql 데이터 조회를 팀원도 조회할 수 있도록 외부로 노출하기 위함</td>\n</tr>\n<tr>\n<td>qa</td>\n<td>redis-lb</td>\n<td>qa 환경 redis 데이터 조회를 팀원도 조회할 수 있도록 외부로 노출하기 위함</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><code class=\"language-text\">kubectl get services --all-namespaces</code><br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACfklEQVQoz12S227aQBCGN0AC2GAILTk0h0ISEh8An70+YBto2qhSpUqRqkS9q0qL1MpV+yDxTV42soyns5bai1z8mvU/u7M735jc392Z9MPt45nmPJzrfjoygvTC8NPBlKYDlaYSnaeT4DpVvGUqOnHpDVW31LHqpHPzOv2y/PRwe//5UXZmNhkEy5/94B0IZliqPnWhNnagqjjQMmbQsSLo2DHGGHMeNDUfeD2ALcmCJkZhEsCeFsFLdwHtsf2L8BP7q+DE0LLjp57/JuOtOCOyXartzLOuu8xqUy/DPOaibFv1sx0tyIhkZXV9lpGxg2vziYgm1CXjO2mr7kqgC+DtOMfDBRYBMqZAJBsvmQN6UMGXYR7azgKwCNRUH4howQ6+sDKmBV6eb2FHDdlck33V+XZIY+jbYX7ozos9O4LWlEJDsYCtD9w5dDQP8xG8MGcgqC70jAC4sQ27GKvPC/Y0umojK8GKcmRWbE8o7CBHFtuMqxVClyHBPRXZBg4ZdrA4Y8gz73nBtkpX1YkLTTPMkU+BbAA3lEIPOBwKUwMPM4+1zJkRlMyetdwsC07pCk1A4HlDn7FkQRSnjJwZFugzrkXTCEuP7WmhhwxxHRT/Clbwz6iL+pr0JXXFixocWEHWU2nOS8amJZsoY3NozTav7FkZMb8RFGvT173NkRNtOEkv19UJzbF4xl6MTNdEit6u9/0b6CLsDoqTkQ0OhEPt6h7s4kB6ug9djDwOgu1h39geCDi8GmIQcFjy+49wNb/5QUzDuVI07/fpmZi8PheT4YWMkpLhpZKcipPkeCT/1+nVODlBf3iB8UxJjgZycjKQkktRTUIv/DMaydJfVQQiVUkhlncAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2 0\"\n        title=\"2 0\"\n        src=\"/static/77f942901194a243a73c3cbd30bdce40/c1b63/2-0.png\"\n        srcset=\"/static/77f942901194a243a73c3cbd30bdce40/5a46d/2-0.png 300w,\n/static/77f942901194a243a73c3cbd30bdce40/0a47e/2-0.png 600w,\n/static/77f942901194a243a73c3cbd30bdce40/c1b63/2-0.png 1200w,\n/static/77f942901194a243a73c3cbd30bdce40/d61c2/2-0.png 1800w,\n/static/77f942901194a243a73c3cbd30bdce40/97a96/2-0.png 2400w,\n/static/77f942901194a243a73c3cbd30bdce40/8b46e/2-0.png 3282w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</blockquote>\n<blockquote>\n<p><code class=\"language-text\">부하 분산 장치</code><br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACV0lEQVQoz42R227aQBCGfUUJEcT2Gh/WmPiA8RlzChDAAaqQqBVEfZTKfftYmengEvWmF7349M/O7s5o/hEC09Vmmf9z/PD4a7Pel6t1USb5rOyZVsl5rzRJTVLOSXv3pWH2S045g85W3ykd1y9dwiYsy7aE0I+/zncb3L684rx4xnyywjyZoz9aoxM/oBPNSRfoXeJhhsN4gl40xSCZYf5Q4OqxwM3mCZ/2zzgMoh+Cazv78WJWBVlazVbr993Trjpsi2pd7KvluqhWVx43RbVYLqskyaosn9QaRHGlc/NdUbV3XTeQMeUspHG4D/IpjqZLnOYT8AYD8H0fXMcGQ9dBliVQmAyyJNWxKN7B3d2FTq2dThva7TZpB0nfhMlsdognOXrOPfa5AbphoG3bqBsczZ5VKzc5iqKEoiSh9Ikso/wHuILU4E3Is+yQjMboeIP6knOO2+0WNU2vkRlDg5romoqMPilX2KWoKGK324ULIsV1wel8coiSFC2rj6qqgqZpuNkWyLiHhp2g2o/Qsz3M4xDTKMQsinCcppgMfeQKQ4WKKQoDphooysqbkI78/XQ5gihOwHXdjyzL4Hh8AVFzgDsZdK0QHKsPozCAOAggi0LI0wTGSQyWpgKN/kHefrCuTpZQwXjoH+J0hPPFEj3Pg5S6H49HbN3e0tYY+UU+0XhMluqR/yLVefITrmCnQyPHUbAb0GY98pDGBV3Xaw9brVZt/sWb2p9/cL2Dzze06bPQabdFRVG+0YMzrf1EyRMt4dRoNE7Nm5tTs9n8H87E90bjC/sNwUMBqz9kbGUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2 1\"\n        title=\"2 1\"\n        src=\"/static/218a70927c2f1123785597f15582ed5a/c1b63/2-1.png\"\n        srcset=\"/static/218a70927c2f1123785597f15582ed5a/5a46d/2-1.png 300w,\n/static/218a70927c2f1123785597f15582ed5a/0a47e/2-1.png 600w,\n/static/218a70927c2f1123785597f15582ed5a/c1b63/2-1.png 1200w,\n/static/218a70927c2f1123785597f15582ed5a/d61c2/2-1.png 1800w,\n/static/218a70927c2f1123785597f15582ed5a/97a96/2-1.png 2400w,\n/static/218a70927c2f1123785597f15582ed5a/6871f/2-1.png 2688w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</blockquote>\n<p>외부로 노출된 svc는 총 3개인데 위의 리소스 그룹에서는 <code class=\"language-text\">공용 IP 주소</code> 가 4개가 존재하였습니다. 한개는 뭘까요?</p>\n<h1 id=\"aks-slb-공용-부하-분산-장치-사용\" style=\"position:relative;\"><a href=\"#aks-slb-%EA%B3%B5%EC%9A%A9-%EB%B6%80%ED%95%98-%EB%B6%84%EC%82%B0-%EC%9E%A5%EC%B9%98-%EC%82%AC%EC%9A%A9\" aria-label=\"aks slb 공용 부하 분산 장치 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>aks slb (공용 부하 분산 장치 사용)</h1>\n<p><code class=\"language-text\">공용 IP 주소</code> 의 기본 정보를 보니까 태그에 친절하게 k8s metadata 들어가있어서 쉽게 찾을 수 있었습니다.</p>\n<blockquote>\n<details>\n<summary>► 공용 IP 주소들 자세히 보기</summary>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 870px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAD20lEQVQ4y5WU21LbVhSGbRhmUgfbOtiSbB1tHXxAko2NbByITzEpKYRM28gt6QwXwDC9A3rDi/RFol603HT6HC03vehDpN3W6toGHNpMM9OLf5as0f7mX/9a24nvnnQS64bRCjZKb5SK/bq9sRn2+4NwOByHo8Eo7AbdsFZ3Q9uphk6lGpZNO1Q1LRSlYigWlFAqyKEgiIeqqo8TiUQyAQCJZrX+Q9BywW93YfBsH3q9IbSDLWhv9qHmB6AZFhRkfS7NsMGueuD7TfBcD1zXh0YrgEq1/jsCs6jEcm80ftt9uQvjL/bf9Z/tEb+/Q2yvQ+qlOnHNOjGbQ+K0xkT3toi9PiCNJy/I051XZPB8n0zGO3++nn4Dw+HkN2TlKXCp5rlRZ7QNW5MhWXO9uDfsx+F0Gk/39+LDg5fx5+GbeP/Vl/HzvYN4srsX73z6WdzdHsSGU4s1VZvlcjkQRelmAXRrTlSv1kAr1UhRLYFqOODUfHDcNjh+ByprTbBqDSiXTTB0FcolA+SCBBzLQDabnaVSKVhdfXyzsrJyC2xudCITs6gOdsh4NIbtp31Yb7UhCDrQ7fZgA2urHeC7Fubbg8FgAEVZBoZlgWWYWY7nAV2+d7g5nkQVzwcmlyOqqoIgCMDzOZAKBeD4PFYZBFECRVEgk8nMxTAMsBTIsjOW4yn8JplM3gKDoBVZlgmZdJp47hq2VgaO40ASBcjnBRClAs0IisXiHMKjI46jwue8OBNk/J5/6HD7aWTZFr4UiFqugmz6wEs68KKGAI7mNHel6zoYhjH/TcHUJWp2V2+WlpZugb3eKDLLNnVAKjUX7XPA5bDtnAgsOqWHKdBxHDBNE9Lp9H27ty1T+MOWNwdBZFUMyOUlYq51gRNVBKTvdJsXdWVZFi6yizHkFxky90B0uAD2hn7kVA38UCJrOBy8XvMVsW17LjokCpZxshY6pPkugNjyB8Bm04/K5RJkcSg8bSObBlrpQKgbCqAOJbx6hu3NN+CjwIbvR4auAV9QSKk1ALXeBq6owyepR5BafQzZxWEWn9mHsP9w2PAjVVWgYdfI11+dxdPDb+ODvWk86g3jSbAVKzwfZxgm5lg2Zj/U7G44Dx16bzV0KDLMO0vRiC4VialqxC5ZxFJ0YsgyyQsCSa+uEszy3/rrbtl/XayN73nXVQfXBu+xZrsgKyperSIUcJELWPH/D3SU9hEpsvzH/WInRUG4erG7+8vV1dWP5+fn15eXl//QxcXF9TmK1rOzs+vj4+Prk5OTe/10enr689HR0ffIyiRwGBT6CMWh+Lv6f0XPpZaXl5N/A0oCvYLs4nBiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/fac70e4c7b6da60600e96c5452c7d1bc/3f3b9/3.png\"\n        srcset=\"/static/fac70e4c7b6da60600e96c5452c7d1bc/5a46d/3.png 300w,\n/static/fac70e4c7b6da60600e96c5452c7d1bc/0a47e/3.png 600w,\n/static/fac70e4c7b6da60600e96c5452c7d1bc/3f3b9/3.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 870px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADyUlEQVQ4y5WTS0/jVhTHExBSKcSJ7djOw7Ed23ES/CAJ5OEk5AWMmOExHYSRZlSxAMQWZjZ8kfki4y5aNlU/R8umi36IaW98euyERzuaSl38dOVr+3f/95x7Yx+6rVhdURrNzeI7sWyc1Bstr9fre8Ph2JuMJ16n1fEqVdMrGeUIVdW9giR5QibnCVnRy2TzHs8LbwsFeRKLxeIxAIjVKms/NBsWrG+0Ybh9AB13BJutPjS7I7BqbZCUEuREJUIuGlCq2OA4NbAtGyzLgfV6E8qVtd9RmERii+548ql9uAeT44PPg+194gx3ieG0iamaxNZNotcnpLyxTRSnT4zGiKx3X5Kt3ddk+OKA7Ex2/zw5/R5Go53f0MWFwoWqbfmtcR96OyNiWnbgjgbByakXnO7vB2+PDoM33rvg4PVx8OLVUbCztx/s7r0KWr1BoBjVoFCQprhlyOVy949Ca63srxkG5HMiycsGFIoVMMwGGPYmGFYDSloRirIEqiJDEVGLCkgFEViGBipJTZeXl2FlZeV+aWlpJqxttnwNa7E23iWDwQDabhdq9QY0W21otzvQ7Xah1+tBr9+HLXzvui4MhyMQRREYhplyHAcsyz4l7Ex2/LLtQCrNEalQAIHn8YM0ZLJZYFgOsJvACxnI5/NAUdQjqVQKaJqe0gwLKZq+j8fjM2Gz2fB1XQMqkSCWZYKqquHKkBEE4DgehEwWBBRinYCh6TBNBINbZjlhyufxezb9LGF/y9dLOtAsR0SsX15zgM0owAoFXJmBZDIZJZJlGRRFiZ4xWZQQmc7H+4WFhZnQdce+ppbCBKRctSIJk+YjaEwa/hwKDWycpmmQSCSiuTnTSP58y51h09fLCqS5LNHMNjCYjKISc2a1ClPpug6mZUE6nX6oXyiaztM+Cd2R4xsVBXg+gzW0QdX0KIlRKkWpwiaFQhGbouN8WN9HIW75C2Gt5vhqsQgr2BQsbrjqHCaCQtnK6ioIeaxhyY5OwH8KHcf2dSz2hpwjLdOEBh7kuirNKEpQw7GFZDFZIkk/l31FuI4J5QK41So5PDgJjo9OgzdH3oxDL/gOnyfNdiCkqAATByh4znTenCfhumN/kvFqrSbpz7yoEj6vEEGcweUkolVtkhVlgteLYJP+zV/zg/7r47FxbPuuXDZAlBQolky8UnlsQO4fhHdXkqSvgg374+Fgx7GLty/39n65vb398fr6+u7m/fsvubmJuLq6ujs/P7+7uLh44KfLy8ufz87OPqKLiimyFEq/QRiEnY//l/C/bxcXF+N/Ay46wNTcQQYjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/1571d2b18edd35b754c54c0d30eea5ab/3f3b9/4.png\"\n        srcset=\"/static/1571d2b18edd35b754c54c0d30eea5ab/5a46d/4.png 300w,\n/static/1571d2b18edd35b754c54c0d30eea5ab/0a47e/4.png 600w,\n/static/1571d2b18edd35b754c54c0d30eea5ab/3f3b9/4.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 870px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAD00lEQVQ4y5WTy3LjVBCGnaQCTCq+SLItybIulmTJF0l2FN/jOLaTDBmSmdRAlGJCVRZOUuwmKRbkRXiREQvwhuI5IBsWPMTAsZqWbHIBCorFVy2f0vn9d//q2Fe9VmxDUdxmo3CWN42TDbfl9fvb3nA49nZHu16n3fXKFcszjJJnmCVP1XRPlCSP5XIey+c9jhe8bJZ9I4ryOBaLLcUAIFYvVb5tuhbUNtuws3sEnc4ObDa3YLMzgGqtBZKsAy/IEbJShGLJBsepg23ZYFkO1NwmmKXKLyiYRGIr3dH4XfvlAYw/PXo/2D0kzs4+MZw2qapVYutVotVHxNwcE8XuE8MdklrvBdnePyY7z4/I3nj/t5PTL2A43PsZtTKh4HLZtvzWqA9be0NSteygOxwE3ulpcHp4GLw5fhm89s6Co+PPgueHr4K9g8Ng/+NPgtbWIFCMciDLygxbBp7P3WHHc0GrYvoVwwAhlyeCbIBYKIFRdcGwG2BYLuiqAgVZgoIyRy0oIOUFYCgKkqnkbG1tDdbX1+9WV1fngvVGy9dwFpXRPhkMBtDpboFTq+Mse9BstcF1Xeh2e9DrbQEGBt1eD2sfOJ4HhmFmmUw6rHf3LXfGe75pO5BKZ4gkisBms8Ck08BxPNBMBrhcHrIsB4IgQCKRuCeVSgFFUTOKZiBFUXdLS4uWm03X13UNEvE4sawqqKoKNE0Dx7KQyWSA5ThgUTCXywGNbaKbCJrG5ww7ywr4PpN+5LC/7etFHSgmQ/I4P0FzgOEUYFgR/5mGZDIZOZJlGRRFiZ7RWeQQmS3q3fLy8lyw2x35mloMHRCzbEUidDobQaHT8HIoYmBwmqZBPB6PzhbMIvHHLXd2mr5uKpDO8ESrtoFGZ4lEfMF8VqFLTdOhUqncu1sIzRa/HwS7Q8c3SgrOiyNVDEfViogGRXQUuspiSKFwGIquqU8FseW/Cdbrjq+qhSgUhsIXk4kF8XkNL6BDDldPKdoYSPrfBWuO4yv44TJ8nmiNEQilDcgZDsjVBshlF8NKR4JRQKkHd09m+MRhzfFFMQ+1Ypmcff5lcIK8fnUW2LVmoFiNQJILAcexAV4K8PJfmS2EH1KuO847SRKBZ7LvTd0mal4iCsuS5LMPyNqzDwmVShEUIxjMP/F7GBjy071Dx7amJdPEjRAgh5uSw+HncFdFSQYJEfHsv8DAfv3zw17CVbt9cXDw4+3t199dv307vbm5mXN9Pb1+RHh2dXU1nUwm04uLi+kkZDL5/vLy8ofz8/NvUCsRwzBC0Y8QGmEW9f8S3ltbWVlZ+gMC0b2bUI3CuwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/6ed1f53155399d29287e6033bc4b2dc6/3f3b9/5.png\"\n        srcset=\"/static/6ed1f53155399d29287e6033bc4b2dc6/5a46d/5.png 300w,\n/static/6ed1f53155399d29287e6033bc4b2dc6/0a47e/5.png 600w,\n/static/6ed1f53155399d29287e6033bc4b2dc6/3f3b9/5.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 870px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAD2klEQVQ4y5WTXXPiVBjHoZ3qaoeXJJBXSEJeCNAkUGwoUKDQUre13V11N4ytM72g7ejVtuOF/SJ+kY0X2hvHz6G98cIPsXrI45OUpVt1dPbiP084w/md/3n+z0l8020l1lW16W2UTgpW+cV6s+VvbfX80WjX30W1W22/WrN9s1zxy1bF1w3Tl2XZ53jR54SCzwuSz7LccbGo7CQSiWQCABKNSu17r2lD/aNN2N49gs32NnibffA6Q6jVWyCrBgiSglLjb9NywHUb4NgO2LYL9aYHVqX2GwIzqMRyZ7TzavPJPux8fvR6sHtInP6YGLZHqmqVrGlVotWHpLw+IordJUZjQOqdA9Lfe0a2Hx+R3dH4jxeTL2E4HP+KrHwEXKo6dtAa9WBrPCRrthN2hoPQn0zCyeFhePz0SfiZfxIePXsefnz4NBwfHIV7+5+Era1BqJiV0DTMmSiIgNe+XQDtmhXUymWQBImIiglFxYBytQ5lt4XyoGI3wbDWQFMVKCkylLDKxQLQFAUURc1WV1cBdbuysnIHbGy0Ah17URvtkcFgAO1OF9x6I669Xh863R543iZgWNDtdvHbg36/DwI6o2l6ls/lIJdj7h22d8aB5biQzeWJXCwCx7LA4J94XgCayQMnSMByPEiSBOl0GjKZTFyz2WzskKIZyFLUbTKZvAN6XjMwDB3SqRSxbbyapgND08BzHOTzLHAI5hAoimIEAIZhYtE0fue5GStpeHDuLYe9fmCYBlBMnhRKFRBKNtCcDAwqS9ELR4qigKqq8e8IHDlEzeb1dmlp6Q7Y6YwCXTPRgUCqaw4oagkKshodEPUo3hwByxicruuQSqXitblmMfztK7e3vcCwVMjleaLbbWClElB4KrZg0avIlWEYOMg2Xp97078INJu7vQd2hm5QrqiQZ3mcQxdKmoF91MBER5ErFkOKwAUMxUCHUf8WQLzyP4CNhhtoWgkyGApDZYHOpIGKlbqr0QZ0yOPzU00Hgbn/BtZdN1BxYBmhQPSNEUiVBohWHdS1DVCqTexlLgbGAWWpBexBDx84rLtBESe/YVbJyRdfhZPjr8NP95+HuuOFmr0RFpVSyPNciJtC3Px3zebg+5QbrvtKlosgMOxry3CIVpCJkmPI6qP3yOoH7xMMiCCMYDD/pj+jwFC/LBy6jn1TsSzgRQlEfCkiNl8sFEDGuZNlBYq49n/CV/T7m8FO4lO7Ptjf//n6+tsfLl++vLm6uop1eXn5QNHaxcXFzXQ6vTk7O7uZRppOfzw/P//p9PT0O2SlExhGBH2EolHMvL6ron0fLi8vJ/8CJhC+MY1cwPoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/9d694e0a0a6f5191db2b8ee6842a01ab/3f3b9/6.png\"\n        srcset=\"/static/9d694e0a0a6f5191db2b8ee6842a01ab/5a46d/6.png 300w,\n/static/9d694e0a0a6f5191db2b8ee6842a01ab/0a47e/6.png 600w,\n/static/9d694e0a0a6f5191db2b8ee6842a01ab/3f3b9/6.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</details>\n</blockquote>\n<p>type이 <code class=\"language-text\">aks-slb-managed-outbound-ip</code> 인 리소스이였는데 AKS 클러스터의 송신 트래픽을 허용하기 위한 공용 IP 인거 같습니다.\n해당 부분에 대해서는 더 깊게 찾아보지 않아서 궁금하신 분들은 <a href=\"https://github.com/Azure/AKS/issues/1281#issuecomment-543867504\">Undocumented public IP in AKS-provisioned load balancer</a> 를 읽어보시면 좋을 꺼 같습니다.</p>\n<h1 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h1>\n<p>k8s에서 IP를 필요로 할 때 Azure가 어떻게 핸들링 하는지 아주 간단하게 알 수 있었습니다.</p>\n<p>각 클라우드 프로바이더마다 처리 방법이 다르겠지만 그래도 역시 기존에 있던 클라우드 자원을 잘 조립해서 처리하는 방향일 것 같습니다.</p>\n<p>읽어주셔서 감사합니다 :)</p>","frontmatter":{"title":"k8s의 EXTERNAL-IP는 Azure에서 어떻게 처리될 까?","date":"December 06, 2021"}}},"pageContext":{"slug":"/azure/how-is-k8s-external-ip-handled-in-azure/","previous":{"fields":{"slug":"/golang/lets-create-an-http-cache-server-with-golang/"},"frontmatter":{"title":"간단한 HTTP 캐시 서버를 만들어보자 (with golang)","category":"golang","draft":false}},"next":{"fields":{"slug":"/essay/belf-project-retrospective/"},"frontmatter":{"title":"MSA로 개발해 본 Belf 프로젝트 회고","category":"essay","draft":false}}}},"staticQueryHashes":["2486386679","3128451518"]}